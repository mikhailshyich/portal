@inject NavigationManager navigationManager

<table class="table table-hover text-center">
    <thead>
        <tr>
            <th><input class="form-check-input" type="checkbox" /></th>
            @foreach(var header in TableHeader)
            {
                <th scope="col">@header</th>
            }
        </tr>
    </thead>
    <tbody>
        @if(MainWarehouses?.Count > 0)
        {
            @foreach (MainWarehouse warehouse in MainWarehouses)
            {
                <tr>
                    <td><input class="form-check-input" type="checkbox" @bind-value="@warehouse.Id" /></td>
                    <td>@warehouse.Title</td>
                    <td>@warehouse.UserDepartment?.Title</td>
                    <td>@warehouse.Description</td>
                    <td><button class="btn btn-secondary btn-sm mx-1" @onclick="() => GoToMainWarehouse(warehouse.Id)">Перейти</button></td>
                </tr>
            }
        }
        else if(Hardwares?.Count > 0)
        {
            @foreach (Hardware hardware in Hardwares)
            {
                <tr>
                    <td><input class="form-check-input" type="checkbox" @bind-value="@hardware.Id" /></td>
                    <td>@hardware.Title</td>
                    <td>@hardware.Description</td>
                    <td>@hardware.CombinedInvNumber</td>
                    <td>@hardware.InventoryNumberExternalSystem</td>
                    <td>@hardware.DateTimeAdd</td>
                    <td><button class="btn btn-secondary btn-sm mx-1" @onclick="() => GoToMainWarehouse(hardware.Id)">Перейти</button></td>
                </tr>
            }
        }
        else if (UserWarehouses?.Count > 0)
        {
            @foreach (UserWarehouse warehouse in UserWarehouses)
            {
                <tr>
                    <td><input class="form-check-input" type="checkbox" @bind-value="@warehouse.Id" /></td>
                    <td><a href="/user/@warehouse.User?.Id">@warehouse.User?.LastName @warehouse.User?.FirstName</a></td>
                    <td>@warehouse.Title</td>
                    <td><button class="btn btn-secondary btn-sm mx-1" @onclick="() => GoToUserWarehouse(warehouse.Id)">Перейти</button></td>
                </tr>
            }
        }
        else if (CategoriesHardware?.Count > 0)
        {
            @foreach (CategoryHardware category in CategoriesHardware)
            {
                <tr>
                    <td><input class="form-check-input" type="checkbox" @bind-value="@category.Id" /></td>
                    <td>@category.Title</td>
                    <td>@category.ShortTitle</td>
                    <td><button class="btn btn-secondary btn-sm mx-1">Редактировать</button></td>
                </tr>
            }
        }
        else if (UserDepartments?.Count > 0)
        {
            @foreach (UserDepartment department in UserDepartments)
            {
                <tr>
                    <td><input class="form-check-input" type="checkbox" @bind-value="@department.Id" /></td>
                    <td>@department.Title</td>
                    <td>@department.ShortTitle</td>
                    <td><button class="btn btn-secondary btn-sm mx-1">Перейти</button></td>
                </tr>
            }
        }
        else if (UsersList?.Count > 0)
        {
            @foreach (UserView user in UsersList.OrderBy(u => u.LastName))
            {
                <tr>
                    <td><input class="form-check-input" type="checkbox" @bind-value="@user.Id" /></td>
                    <td>@user.LastName</td>
                    <td>@user.FirstName</td>
                    <td>
                        <button class="btn btn-secondary btn-sm mx-1" @onclick="() => ShowUser(user.Id)">Перейти</button>
                        <AuthorizeView Roles="admin">
                            <Authorized>
                                <button class="btn btn-primary btn-sm mx-1" @onclick="() => EditUser(user.Id)">Редактировать</button>
                            </Authorized>
                        </AuthorizeView>
                    </td>
                </tr>
            }
        }
        else if (DocumentExternalSystemList?.Count > 0)
        {
            @foreach (DocumentExternalSystem document in DocumentExternalSystemList)
            {
                <tr>
                    <td><input class="form-check-input" type="checkbox" @bind-value="@document.Id" /></td>
                    <td>@document.Title</td>
                    <td>@document.ShortTitle</td>
                    <td>
                        <AuthorizeView Roles="admin">
                            <Authorized>
                                <button class="btn btn-primary btn-sm mx-1" @onclick="() => EditDocument(document.Id)">Редактировать</button>
                            </Authorized>
                        </AuthorizeView>
                    </td>
                </tr>
            }
        }
        else
        {
            <tr>
                <td colspan="10">
                    <div class="text-center">
                        <div class="spinner-border text-success" role="status">
                            <span class="visually-hidden">Загрузка...</span>
                        </div>
                    </div>
                </td>
            </tr>
        }
    </tbody>
</table>

@code {
    [Parameter]
    public List<string> TableHeader { get; set; } = new();
    [Parameter]
    public List<MainWarehouse>? MainWarehouses { get; set; } = new();
    [Parameter]
    public List<Hardware>? Hardwares { get; set; } = new();
    [Parameter]
    public List<UserWarehouse>? UserWarehouses { get; set; } = new();
    [Parameter]
    public List<CategoryHardware>? CategoriesHardware { get; set; } = new();
    [Parameter]
    public List<UserDepartment>? UserDepartments { get; set; } = new();
    [Parameter]
    public List<UserView>? UsersList { get; set; } = new();
    [Parameter]
    public List<DocumentExternalSystem>? DocumentExternalSystemList { get; set; } = new();

    private void GoToMainWarehouse(Guid id)
    {
        navigationManager.NavigateTo($"/main-warehouse/{id}");
    }

    private void GoToUserWarehouse(Guid id)
    {
        navigationManager.NavigateTo($"/main-warehouse/{id}");
    }

    private void CheckboxChanged(ChangeEventArgs args)
    {
        throw new NotImplementedException();
    }

    private void ShowUser(Guid id)
    {
        navigationManager.NavigateTo($"/user/{id}");
    }

    private void EditUser(Guid id)
    {
        navigationManager.NavigateTo($"/user/edit/{id}");
        
    }

    private void EditDocument(Guid id)
    {

    }
}
